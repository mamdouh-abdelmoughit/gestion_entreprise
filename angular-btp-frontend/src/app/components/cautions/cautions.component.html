<div class="cautions-container">
  <div class="cautions-header">
    <h2 class="cautions-title">ðŸ’° Cautions</h2>
    <button routerLink="/cautions/new" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
      Nouvelle Caution
    </button>
  </div>

  <div class="cautions-content">
    <h3 class="content-title">Liste des Cautions</h3>

    <div *ngIf="isLoading" class="loading-state">
      <div class="loading-spinner"></div>
      <p>Chargement...</p>
    </div>

    <div *ngIf="!isLoading && !error && cautionsPage" class="table-container">
      <table class="min-w-full bg-white">
        <thead class="bg-gray-100">
        <tr>
          <!-- FIX: Added header for Numero -->
          <th class="py-2 px-4 text-left">NumÃ©ro</th>
          <th class="py-2 px-4 text-left">Type</th>
          <th class="py-2 px-4 text-left">Montant</th>
          <th class="py-2 px-4 text-left">Date d'Ã‰chÃ©ance</th>
          <th class="py-2 px-4 text-left">Statut</th>
          <th class="py-2 px-4 text-left">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let caution of cautionsPage.content" class="border-b">
          <!-- FIX: Changed caution.nom to the correct property, caution.numero -->
          <td class="py-2 px-4 font-medium">{{ caution.numero }}</td>
          <td class="py-2 px-4">{{ caution.type }}</td>
          <td class="py-2 px-4">{{ caution.montant | currency:'EUR' }}</td>
          <td class="py-2 px-4">{{ caution.dateEcheance | date:'dd/MM/yyyy' }}</td>
          <td class="py-2 px-4">
        <span class="px-2 py-1 text-xs rounded-full"
              [ngClass]="{
                'bg-green-200 text-green-800': caution.statut === 'ACTIVE',
                'bg-red-200 text-red-800': caution.statut === 'EXPIREE',
                'bg-gray-200 text-gray-800': caution.statut === 'CLOTUREE'
              }">
          {{ caution.statut }}
        </span>
          </td>
          <td class="py-2 px-4">
            <button [routerLink]="['/cautions/edit', caution.id]" class="text-blue-600 hover:underline">Modifier</button>
            <button (click)="deleteCaution(caution.id)" class="text-red-600 hover:underline">Supprimer</button>

          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
